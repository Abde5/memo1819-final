\chapter{Thin two-level graphs}
\label{chap:twolevel}

Breu \cite{breuAlgorithmicAspectsConstrained1996} has presented in his thesis a similar class of constrained unit disk graphs where the disks are placed on $k$ horizontal parallel lines. More formally: a disk $(x,y)$ can be placed in $x \in (-\infty,\infty)$ and $y \in L$ with $|L| = k$.

In this chapter I define thin two-level graphs as a two-level graph where $L = \{0,\varepsilon\}$ and $\varepsilon$ is an arbitrarily small real number.


\section{Thin two-level graph}

A two-level graph can be defined intuitively as a strip graph such that the disks are placed only on the horizontal lines. In the same way,
we can define also

\begin{figure}
\centering

\begin{scaletikzpicturetowidth}{\textwidth}
\begin{tikzpicture}[scale=1.5]

%graph
\node[draw,circle,inner sep=1pt,fill,label distance=1cm] (v2) at (0,0.85) {};
\node[draw,circle,inner sep=1pt,fill,label distance=1cm] (v2) at (-0.5,0) {};
\node[draw,circle,inner sep=1pt,fill,label distance=1cm] (v2) at (0.5,0) {};
\draw(0.5,0)--(-0.5,0)--(0,0.85)--(0.5,0);

\node[draw,circle,inner sep=1pt,fill,label distance=1cm] (v2) at (0,0.5) {};
\node[draw,circle,inner sep=1pt,fill,label distance=1cm] (v2) at (0.2,0.2) {};
\node[draw,circle,inner sep=1pt,fill,label distance=1cm] (v2) at (-0.2,0.2) {};
\draw(0,0.5)--(0.2,0.2)--(0.2,0.2)--(-0.2,0.2)--(0,0.5);

\draw(0,0.5)--(0,0.85);
\draw(-0.5,0)--(-0.2,0.2);
\draw(0.2,0.2)--(0.5,0);


\end{tikzpicture}
\end{scaletikzpicturetowidth}

\caption{ Forbidden graph in TTLG }
\label{fig:forbSigma}
\end{figure}

This class of graphs is close to our main class TSG. But we have to know at what point we can rely in this class of graphs to study TSG:

\lemma[Breu \cite{breuAlgorithmicAspectsConstrained1996}]{
  \label{lemma:chordlessLEVEL}
  Let $abcda$ be a chordless 4-cycle in a two-level graph $G=(V,E)$. Then $ad$ and $bc$ are level edges (they are adjacent in the same level), and the others are cross edges for every realization $\phi$ of $G$ for which $\phi(a)_x<\phi(c)_x$ and $\phi(b)_x<\phi(d)_x$.
}


With this preliminary result, we proceed to one of our main result:

\theorem{TTLG $\subsetneq$ TSG}

\proof{By definition, we know that TTLG $\subset$ TSG because the area where the disks can be placed in TTLG is included in the area in TSG.

We can prove that TTLG $\neq$ TSG because we can construct a graph $G$ such that $G \in$ TSG and $G \notin$ TTLG. This graph $D$ is a net$^*$ graph as described in Figure \ref{fig:forbSigma}.

\begin{proofpart}
  $D$ is a TSG because we can realize it as a TSG if we take as center of disks $(0,0)$, $(0,z)$, $(0,\epsilon)$, $(1,0)$, $(1,z)$, $(1,\epsilon)$ such that $0 < z < \epsilon$.
\end{proofpart}
\begin{proofpart}
  Now we have to prove that $D$ is a forbidden induced subgraph of TTLG. We will try to construct it by taking an induced subgraph that is realizable: we take $D_{-1} = D - x$ with $x\in V(D)$. We notice that $V(D_{-1})$ is a chordless $C_{4}$ ($abcd$) with a vertex $e$ adjacent to any two consecutive vertices $x,y \in V(C_4)$ creating the triangle $xye$.

  By Lemma \ref{lemma:chordlessLEVEL} we know that $abcda$ is a cycle if $ab$ and $cd$ are level edges. We can classify these vertices in two sets: $\ell(V) = {a,d}$ and $r(V) = {b,c}$ where $\forall u\in \ell(V) v\in r(V): u_x < v_x$.

  To realize $D_{-1}$ we have to add a vertex $i$ to $C_4$. We can either put it between two line-vertices or put it between two vertices with different level.
  In the case where we want to put it between two line vertices $a$ and $b$ we have:

  $$b_x < d_x <c_x$$

  In this case, we have $d_x$ that is adjacent to at least one vertex of the other level. The only way to do this is to put it adjacent to two different level vertices ($a$ and $b$). Now that we have a realization of $D_{-1}$, we should add a last vertex $j$ adjacent to $i$, $c$ and $d$. If we put $j$ on the right of the cycle, then $i$ has to be on the left to be able to touch $c$ and $d$. However, it is impossible for $j$ to reach $i$ because between because at each level there is a region $a\cap d$ and $b\cap c$ that neither of these disks can breach, so they will always be disjoint.\qed
\end{proofpart}
}

\subsection{Relation with interval graphs}

The relationship between two-level graphs and interval graphs is clear: a $k$-two-level graph with $k > 1$ gives us a disconnected graph where every connected component is a unit interval graph. Here we could say that a two-level graph $G = F \cup H$ being $F$ and $H$ unit interval graphs.

Furthermore, this relationship between unit interval graphs and two-level graphs is even stronger:

\begin{theorem}[Breu \cite{breuAlgorithmicAspectsConstrained1996}]
For any value of $k$, a $k$-two-level-graph is an union of two unit interval graphs.
\end{theorem}

Before proving this, we have to define:

\begin{defn}
  A short edge $\tau$-two-level graph is a $\tau$-two-level graph $G(V,E)$ such that given $vw \in E$, then $|v_x-w_x| \leq \sqrt{1-\tau^2}$.
\end{defn}

\begin{claim}
  A short edge two-level graph is a unit interval graph.
\end{claim}

\proof{See \cite{breuAlgorithmicAspectsConstrained1996}.}


\proof[Proof of theorem]{
  Let $G =(V,E)$ be a two-level graph. Let have $G_S = (V,E_S)$ the graph induced on the short edges and $G_L = (V,E_L)$ a graph induced on the line-edges (between points in the same line). Both of these graphs are unit interval graphs.

  We can see that $E_S \cup E_L \subseteq E$, we only have to prove that $E \subseteq E_S \cup E_L$. Given an edge $vw\in E$, if $|v_x-w_x| > \alpha$, then $vw \in E_L$ because two graphs on different levels cannot touch. In the other case, when $|v_x-w_x| \leq \alpha$, v and w can be either in the same level or in different levels.

  This shows that every edge of $E$ is in either $E_L$ or $E_S$, so $E \subseteq E_L \cup E_S$. Which means that $G = G_L \cup G_S$.
}

\begin{figure}
\centering

\begin{scaletikzpicturetowidth}{\textwidth}
\begin{tikzpicture}[scale=1.5]
\draw (-2,0) -- (2,0);
\draw[red ,opacity = 0.5] (-2,0.5) -- (2,0.5);

\draw  (-1,0) circle [radius=0.5];
\draw[color=black] (-1,-0.2265) node {$v_2$};
\draw  (0,0) circle [radius=0.5];
\draw[color=black] (0,-0.2265) node {$v_4$};
\draw  (1,0) circle [radius=0.5];
\draw[color=black] (1,-0.2265) node {$v_7$};

\draw[red, opacity = 0.5] (0.1,0.5) circle [radius=0.5];
\draw[color=black] (0.1,0.7) node {$v_5$};
\draw[red, opacity = 0.5] (0.8,0.5) circle [radius=0.5];
\draw[color=black] (0.8,0.7) node {$v_6$};
\draw[red, opacity = 0.5] (-0.6,0.5) circle [radius=0.5];
\draw[color=black] (-0.6,0.7) node {$v_3$};
\draw[red, opacity = 0.5] (-1.2,0.5) circle [radius=0.5];
\draw[color=black] (-1.2,0.7) node {$v_1$};
\draw[color=black] (2.4902,0.2393) node {\tiny $c > 0$};

% lines to describe distance (epsilon)
\draw[very thin] (2.1003,0.5) -- (2.1,0);
\draw[very thin] (2.0489,0.5) -- (2.0997,0.5);
\draw[very thin] (2.05,0) -- (2.1,0);

%graph
\draw plot [smooth cycle] coordinates {(-1.2314,-3.2019) (-2.7314,-1.7019) (-0.7314,-1.2019) } ;
\draw plot [smooth cycle] coordinates {(1.2686,-3.2019) (0.7686,-1.2019) (2.7686,-1.7019) } ;


\node[draw,circle,inner sep=0.5pt,fill,label distance=1cm] (v2) at (-1.4847,-2.4724) {};
\draw[color=black] (-1.4847,-2.3019) node {$v_2$};
\node[draw,circle,inner sep=0.5pt,fill,label distance=1cm] (v2) at (-1.1831,-1.8637) {};
\draw[color=black] (-1.1831,-1.6637) node {$v_4$};
\node[draw,circle,inner sep=0.5pt,fill,label distance=1cm] (v2) at (-1.8649,-1.9094) {};
\draw[color=black] (-1.8649,-1.7094) node {$v_7$};

\draw plot [smooth,tension=1.2] coordinates {(-0.6778,-1.3597) (-0.0024,-1.0888)(0.7295,-1.288)} node at (1,0) {};
\draw plot [smooth,tension=1.2] coordinates {(-0.9968,-2.8499) (-0.0099,-2.5359)(1.0588,-2.9266)} node at (1,0){};
\draw plot [smooth,tension=1.2] coordinates {(-0.7488,-2.0147) (0.0223,-1.6933)(0.7878,-2.0368)} node at (1,0){};

\node[draw,circle,inner sep=0.5pt,fill,label distance=1cm] (v2) at (1.86,-2.1379) {};
\draw[color=black] (1.86,-1.8979) node {$v_1$};
\node[draw,circle,inner sep=0.5pt,fill,label distance=1cm] (v2) at (1.399,-2.509) {};
\draw[color=black] (1.399,-2.309) node {$v_3$};
\node[draw,circle,inner sep=0.5pt,fill,label distance=1cm] (v2) at (1.7518,-1.5712) {};
\draw[color=black] (1.7518,-1.4712) node {$v_5$};
\node[draw,circle,inner sep=0.5pt,fill,label distance=1cm] (v2) at (1.2071,-1.8911) {};
\draw[color=black] (1.2071,-1.7411) node {$v_6$};

\end{tikzpicture}
\end{scaletikzpicturetowidth}

\caption{ A representation of a TL($c$) }
\label{fig:sigma}
\end{figure}
